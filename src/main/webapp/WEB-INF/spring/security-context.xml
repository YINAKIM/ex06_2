<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security.xsd
        http://www.springframework.org/schema/beans
         http://www.springframework.org/schema/beans/spring-beans.xsd">


    <security:http>
        <!-- security:intercept-url => 특정 URI접근시 인터셉터를 이용하여 접근제한
             pattern속성 : URI패턴 지정
             access속성 : 권한체크
             access속성 값 지정하는 2가지 방법
             1. 표현식이용 : <security:http>의 기본설정방법 ,
             2. 문자열 이용  : 만약 [2. 문자열]방법으로 하고싶으면 use-expression="false"지정할 것, 그리고 이방법으로 하면 JSP에서 처리할 때 방법이 다름
             -->
        <security:intercept-url pattern="/sample/all" access="permitAll"/>
        <security:intercept-url pattern="/sample/member" access="hasRole('ROLE_MEMBER')"/>
        <security:intercept-url pattern="/sample/admin" access="hasRole('ROLE_ADMIN')"/>

        <security:form-login/>

    </security:http>



    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service>
                <security:user name="member"  password="{noop}member" authorities="ROLE_MEMBER"/>
                                                                <!-- ROLE_MEMBER 라는 권한을 가진 member라는 계정-->

                <security:user name="admin"  password="{noop}admin" authorities="ROLE_MEMBER, ROLE_ADMIN"/>
                                                                    <!-- MEMBER와 ADMIN : 2가지 권한 설정 - /sample/member와 /sample/admin 둘다 접근가능
                                                                         만약 member계정인 사용자가 /admin에 접근하려고 하면 403(Forbidden:금지됨, 서버가 요청을 이해했으나 승인을 거부합니다.) 메세지 보게됨
                                                                         DEBUG: org.springframework.security.web.access.ExceptionTranslationFilter - Access is denied (user is not anonymous); delegating to AccessDeniedHandler
                                                                         org.springframework.security.access.AccessDeniedException: Access is denied

                                                                          -->
            </security:user-service>
        </security:authentication-provider>
    </security:authentication-manager>
</beans>